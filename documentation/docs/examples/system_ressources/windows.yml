shell: 
  type: powershell

sensor:
  - platform: shell
    name: "RAM Usage"
    id: ram_usage
    icon: "mdi:bluetooth-settings"
    state_class: "measurement"
    unit_of_measurement: "%"
    update_interval: 30s # 0 only executes it once and assumes a long running processes.
    command: |-
      Get-WmiObject Win32_OperatingSystem -Property * | % {([math]::Round(($_.FreePhysicalMemory)/$_.totalvisiblememorysize,2))}